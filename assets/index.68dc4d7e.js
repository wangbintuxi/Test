import{_ as Se,G as Ie,a as ze,l as f,bB as $e,d as Ne,r as Oe,k as De,b2 as qe,bC as Fe,o as l,c as h,i as e,m as t,f as s,bE as Re,F as G,bD as W,q as r,x as u,t as z,e as j,w as p,bF as X,s as $,cW as Ge,b3 as Ke,be as k,M as Y,bG as Z,I as Te,bH as Be,bI as Je,D as Ue,bf as Le,bJ as Pe,cK as Ve,d9 as Ee,cL as Me,c5 as Ae,c6 as He,bL as Qe}from"./index.eed59c8a.js";import{_ as We}from"./index.ce53685a.js";import"./index.dc2e029d.js";import{_ as Xe}from"./index.bd1fc01d.js";import{C as Ye}from"./index.dbfe01a9.js";/* empty css              */import Ze from"./CreateForm.a1900b63.js";import et from"./DetailForm.d1645bd2.js";import{l as tt,c as ot,d as ee,r as nt}from"./job.e515d67c.js";import{_ as at,F as st}from"./Form.ebe4e7a6.js";import{_ as lt,a as ut}from"./index.bd68bfa1.js";import"./index.60929ff8.js";import"./RadioButton.a28003a6.js";import"./index.e50e374b.js";import"./Group.69eabd48.js";import"./Search.63c74586.js";import"./isPlainObject.e1353217.js";import"./Password.525a1a03.js";import"./ShowCron.bd91107d.js";/* empty css               */import"./index.4efc3d67.js";import"./index.686b5bf8.js";const it={style:{float:"right",overflow:"hidden"}},ct=u(" \u67E5\u8BE2 "),rt=u(" \u91CD\u7F6E "),_t={class:"table-operations"},dt=u(" \u65B0\u589E "),pt=u(" \u4FEE\u6539 "),mt=u(" \u5220\u9664 "),bt=u(" \u5BFC\u51FA "),ft=u(" \u65E5\u5FD7 "),gt=u(" \u786E\u8BA4 "),vt=u(" \u4FEE\u6539 "),yt=u(" \u66F4\u591A "),ht=u(" \u4EFB\u52A1\u8BE6\u60C5 "),jt=u(" \u8C03\u5EA6\u65E5\u5FD7 "),kt=u(" \u6267\u884C\u4E00\u6B21 "),Ct=u(" \u5220\u9664 "),xt=Ie({name:"Job"}),wt=Object.assign(xt,{setup(St){const{proxy:N}=Ke(),te=ze(),{sys_job_group:O,sys_job_status:D}=N.useDict("sys_job_group","sys_job_status"),K=f([]),T=$e(),C=Ne({get(){return T.size},set(o){T.setSize(o)}}),oe=f(!1),q=f(null),B=f(null),x=f(!0),J=f(!0),U=f(!0),L=f(0),ne=Oe({selectedRowKeys:[],queryParams:{pageNum:1,pageSize:10,jobName:void 0,jobGroup:void 0,status:void 0},columns:[{title:"\u4EFB\u52A1\u7F16\u53F7",dataIndex:"jobId",ellipsis:!0,align:"center"},{title:"\u4EFB\u52A1\u540D\u79F0",dataIndex:"jobName",ellipsis:!0,align:"center"},{title:"\u4EFB\u52A1\u7EC4\u540D",dataIndex:"jobGroup",ellipsis:!0,align:"center"},{title:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32",dataIndex:"invokeTarget",ellipsis:!0,align:"center"},{title:"\u72B6\u6001",dataIndex:"status",ellipsis:!0,align:"center"},{title:"\u64CD\u4F5C",dataIndex:"operation",width:"18%",scopedSlots:{customRender:"operation"},align:"center"}]}),{selectedRowKeys:g,queryParams:i,columns:w}=De(ne),m=()=>{x.value=!0,tt(i.value).then(o=>{K.value=o.rows,L.value=o.total,x.value=!1})},y=()=>{i.value.pageNum=1,m()},ae=()=>{N.resetForm("queryRef"),y()},se=o=>{const n=o.status=="1"?"\u542F\u7528":"\u505C\u7528";o.status=o.status=="0"?"1":"0",ot(o.jobId,o.status).then(()=>{k.success(n+"\u6210\u529F",3)}).catch(function(){k.error(n+"\u5F02\u5E38",3)})},le=o=>{},ue=(o,n)=>{i.value.pageSize=n,m()},ie=(o,n)=>{i.value.pageNum=o,i.value.pageSize=n,m()},F=o=>{g.value=o,J.value=g.value.length!==1,U.value=!g.value.length},ce=o=>{const n=o.jobId;ee(n).then(()=>{F([]),m(),k.success("\u5220\u9664\u6210\u529F",3)})},re=()=>{const o=g.value;Y.confirm({title:"\u786E\u8BA4\u5220\u9664?",icon:e(Z),content:"\u662F\u5426\u5220\u9664\u9009\u4E2D\u6570\u636E",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk(){ee(o).then(()=>{F([]),m(),k.success("\u5220\u9664\u6210\u529F",3)})},onCancel(){}})},_e=o=>{const n=o.jobId;Y.confirm({title:"\u786E\u8BA4\u7ACB\u5373\u6267\u884C?",icon:e(Z),content:'\u786E\u8BA4\u8981\u7ACB\u5373\u6267\u884C\u4E00\u6B21"'+o.jobName+'"\u4EFB\u52A1\u5417?',okText:"\u6267\u884C",cancelText:"\u53D6\u6D88",onOk(){nt(n,o.jobGroup).then(()=>{m(),k.success("\u6267\u884C\u6210\u529F",3)})},onCancel(){}})},de=()=>{},pe=()=>{N.download("monitor/job/export",{...i.value},`job_${new Date().getTime()}.xlsx`)},P=o=>{const n=o.jobId||0;te.push({path:"/monitor/job-log/index",query:{jobId:n}})},me=()=>{q.value.handleAdd()},V=o=>{q.value.handleUpdate(o)},be=o=>{B.value.handleView(o)};return m(),(o,n)=>{const fe=Te,R=at,S=lt,E=Be,M=Je,b=qe("c-icon"),_=Ue,A=Le,ge=ut,ve=st,H=Ye,ye=Pe,he=Ve,Q=Xe,je=Ee,I=Me,ke=Ae,Ce=He,xe=We,we=Qe,d=Fe("hasPermi");return l(),h("div",null,[e(H,{bordered:!1,class:"card card-search p-0",size:"small"},{default:t(()=>[e(ve,{class:"search-form",model:s(i),ref:"queryRef","label-col":{span:8},"wrapper-col":{span:16}},{default:t(()=>[e(ge,{gutter:48},{default:t(()=>[e(S,{md:8,sm:24},{default:t(()=>[e(R,{label:"\u4EFB\u52A1\u540D\u79F0",name:"jobName"},{default:t(()=>[e(fe,{value:s(i).jobName,"onUpdate:value":n[0]||(n[0]=a=>s(i).jobName=a),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",allowClear:"",onKeyup:Re(y,["enter"])},null,8,["value","onKeyup"])]),_:1})]),_:1}),e(S,{md:8,sm:24},{default:t(()=>[e(R,{label:"\u4EFB\u52A1\u7EC4\u540D",name:"jobGroup"},{default:t(()=>[e(M,{value:s(i).jobGroup,"onUpdate:value":n[1]||(n[1]=a=>s(i).jobGroup=a),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u7EC4\u540D",style:{width:"100%"}},{default:t(()=>[(l(!0),h(G,null,W(s(O),(a,c)=>(l(),r(E,{key:c,value:a.value},{default:t(()=>[u(z(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),e(S,{md:8,sm:24},{default:t(()=>[e(R,{label:"\u4EFB\u52A1\u72B6\u6001",name:"status"},{default:t(()=>[e(M,{value:s(i).status,"onUpdate:value":n[2]||(n[2]=a=>s(i).status=a),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u72B6\u6001",style:{width:"100%"}},{default:t(()=>[(l(!0),h(G,null,W(s(D),(a,c)=>(l(),r(E,{key:c,value:a.value},{default:t(()=>[u(z(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),e(S,{md:24,sm:24},{default:t(()=>[j("span",it,[e(A,null,{default:t(()=>[e(_,{type:"primary",onClick:y},{default:t(()=>[e(b,{type:"SearchOutlined"}),ct]),_:1}),e(_,{onClick:ae},{default:t(()=>[e(b,{type:"SyncOutlined"}),rt]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(H,{bordered:!1,class:"card",size:"small"},{default:t(()=>[j("div",_t,[e(A,null,{default:t(()=>[p((l(),r(_,{type:"primary",onClick:n[3]||(n[3]=a=>me())},{default:t(()=>[e(b,{type:"PlusOutlined"}),dt]),_:1})),[[d,["monitor:job:add"]]]),p((l(),r(_,{type:"primary",disabled:J.value,onClick:n[4]||(n[4]=a=>V(void 0,s(g)))},{default:t(()=>[e(b,{type:"FormOutlined"}),pt]),_:1},8,["disabled"])),[[d,["monitor:job:edit"]]]),p((l(),r(_,{class:"is-plain",type:"danger",disabled:U.value,onClick:re},{default:t(()=>[e(b,{type:"DeleteOutlined"}),mt]),_:1},8,["disabled"])),[[d,["monitor:job:remove"]]]),p((l(),r(_,{type:"cyan",onClick:pe},{default:t(()=>[e(b,{type:"DownloadOutlined"}),bt]),_:1})),[[d,["monitor:job:export"]]]),p((l(),r(_,{onClick:P},{default:t(()=>[e(b,{type:"ProfileOutlined"}),ft]),_:1})),[[d,["monitor:job:query"]]])]),_:1}),e(ye,{class:"float-right",columns:s(w),"onUpdate:columns":n[5]||(n[5]=a=>X(w)?w.value=a:null),tableSize:s(C),"onUpdate:tableSize":n[6]||(n[6]=a=>X(C)?C.value=a:null),"refresh-loading":x.value,onRefresh:m},null,8,["columns","tableSize","refresh-loading"])]),e(xe,{loading:x.value,size:s(C),rowKey:"jobId",columns:s(w),"data-source":K.value,"row-selection":{selectedRowKeys:s(g),onChange:F},pagination:!1,bordered:oe.value},{bodyCell:t(({column:a,record:c})=>[a.dataIndex==="status"?(l(),r(Q,{key:0,"ok-text":"\u662F","cancel-text":"\u5426",onConfirm:v=>se(c),onCancel:v=>le()},{title:t(()=>[j("span",null,[gt,j("b",null,z(c.status=="1"?"\u542F\u7528":"\u505C\u7528"),1),u(" "+z(c.partnerName)+"\u7684\u7528\u6237\u5417? ",1)])]),default:t(()=>[e(he,{"checked-children":"\u5F00","un-checked-children":"\u5173",checked:c.status=="0"},null,8,["checked"])]),_:2},1032,["onConfirm","onCancel"])):$("",!0),a.dataIndex==="operation"?(l(),h(G,{key:1},[p((l(),r(_,{class:"ant-btn-sm",type:"link",onClick:v=>V(c)},{default:t(()=>[vt]),_:2},1032,["onClick"])),[[d,["monitor:job:edit"]]]),p((l(),h("span",null,[c.userId!==1?p((l(),r(je,{key:0,type:"vertical"},null,512)),[[d,["monitor:job:query","monitor:job:changeStatus","monitor:job:remove"]]]):$("",!0),c.userId!==1?(l(),r(Ce,{key:1},{overlay:t(()=>[e(ke,null,{default:t(()=>[e(I,null,{default:t(()=>[p((l(),r(_,{class:"ant-btn-sm",type:"link",onClick:v=>be(c)},{default:t(()=>[ht]),_:2},1032,["onClick"])),[[d,["monitor:job:query"]]])]),_:2},1024),e(I,null,{default:t(()=>[p((l(),r(_,{class:"ant-btn-sm",type:"link",onClick:v=>P(c)},{default:t(()=>[jt]),_:2},1032,["onClick"])),[[d,["monitor:job:query"]]])]),_:2},1024),e(I,null,{default:t(()=>[p((l(),r(_,{class:"ant-btn-sm",type:"link",onClick:v=>_e(c)},{default:t(()=>[kt]),_:2},1032,["onClick"])),[[d,["monitor:job:changeStatus"]]])]),_:2},1024),e(I,null,{default:t(()=>[e(Q,{title:"\u786E\u5B9A\u5220\u9664\u5417?","ok-text":"\u786E\u8BA4","cancel-text":"\u53D6\u6D88","ok-type":"danger",onConfirm:v=>ce(c),onCancel:de},{default:t(()=>[p((l(),r(_,{class:"ant-btn-sm",type:"link",danger:""},{default:t(()=>[Ct]),_:1})),[[d,["monitor:job:remove"]]])]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)]),default:t(()=>[j("a",{class:"ant-dropdown-link",onClick:n[7]||(n[7]=Ge(()=>{},["prevent"]))},[yt,e(b,{type:"DownOutlined"})])]),_:2},1024)):$("",!0)])),[[d,["monitor:job:query","monitor:job:changeStatus","monitor:job:remove"]]])],64)):$("",!0)]),_:1},8,["loading","size","columns","data-source","row-selection","bordered"]),e(we,{class:"ant-table-pagination float-right","show-size-changer":"","show-quick-jumper":"",current:s(i).pageNum,total:L.value,"page-size":s(i).pageSize,"show-total":a=>`\u5171 ${a} \u6761`,onShowSizeChange:ue,onChange:ie},null,8,["current","total","page-size","show-total"])]),_:1}),e(Ze,{ref_key:"createForm",ref:q,sys_job_group:s(O),sys_job_status:s(D),onOk:y},null,8,["sys_job_group","sys_job_status"]),e(et,{ref_key:"detailForm",ref:B,sys_job_group:s(O),sys_job_status:s(D),onOk:y},null,8,["sys_job_group","sys_job_status"])])}}});var Qt=Se(wt,[["__scopeId","data-v-06f8c2a4"]]);export{Qt as default};
