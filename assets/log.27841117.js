import{bg as N,G as ge,l as _,u as be,bB as fe,d as ve,r as ye,k as he,b2 as je,bC as we,o as u,c as D,i as e,m as t,f as l,bE as Ce,F as $,bD as J,q as c,x as r,t as P,e as U,w as k,bF as E,s as L,b3 as ke,M as Q,bG as A,be as H,I as xe,bH as Se,bI as ze,D as Ie,bf as De,bJ as Le,bK as Ne,bL as Re}from"./index.b2a8007e.js";import{_ as Oe}from"./index.85ab3c8f.js";import"./index.1a7277f2.js";import{C as Te}from"./index.97ae9f09.js";/* empty css              */import{R as Ge}from"./index.a4e7dbf0.js";import{g as qe}from"./job.03522512.js";import Ke from"./LogView.8c3f8d53.js";import{_ as Ye,F as Be}from"./Form.974d28bd.js";import{_ as Fe,a as Me}from"./index.0d46dd88.js";import"./index.8f8c4724.js";import"./RadioButton.f23841e3.js";import"./index.396ac728.js";import"./Group.2e989739.js";import"./Search.0f62a307.js";import"./isPlainObject.87445d09.js";import"./Password.f34c4271.js";/* empty css               */import"./index.92e9d583.js";function Ve(f){return N({url:"/monitor/jobLog/list",method:"get",params:f})}function $e(f){return N({url:"/monitor/jobLog/"+f,method:"delete"})}function Je(){return N({url:"/monitor/jobLog/clean",method:"delete"})}const Pe={style:{float:"right",overflow:"hidden"}},Ue=r(" \u67E5\u8BE2 "),Ee=r(" \u91CD\u7F6E "),Qe={class:"table-operations"},Ae=r(" \u5220\u9664 "),He=r(" \u6E05\u9664 "),We=r(" \u5BFC\u51FA "),Xe=r(" \u5173\u95ED "),Ze=r(" \u8BE6\u7EC6 "),et=ge({name:"JobLog"}),jt=Object.assign(et,{setup(f){const{proxy:g}=ke(),{sys_common_status:x,sys_job_group:R}=g.useDict("sys_common_status","sys_job_group"),O=_([]),v=_(!0),T=_(""),G=_(!0),q=_(0),y=_([]),W=be(),K=fe(),h=ve({get(){return K.size},set(a){K.setSize(a)}}),X=_(!1),Z=ye({selectedRowKeys:[],queryParams:{pageNum:1,pageSize:10,dictName:void 0,dictType:void 0,status:void 0},columns:[{title:"\u65E5\u5FD7\u7F16\u53F7",dataIndex:"jobLogId",ellipsis:!0,align:"center"},{title:"\u4EFB\u52A1\u540D\u79F0",dataIndex:"jobName",ellipsis:!0,align:"center"},{title:"\u4EFB\u52A1\u7EC4\u540D",dataIndex:"jobGroup",ellipsis:!0,align:"center"},{title:"\u8C03\u7528\u76EE\u6807\u5B57\u7B26\u4E32",dataIndex:"invokeTarget",ellipsis:!0,align:"center"},{title:"\u65E5\u5FD7\u4FE1\u606F",dataIndex:"jobMessage",ellipsis:!0,align:"center"},{title:"\u6267\u884C\u72B6\u6001",dataIndex:"status",ellipsis:!0,align:"center"},{title:"\u6267\u884C\u65F6\u95F4",dataIndex:"createTime",ellipsis:!0,align:"center"},{title:"\u64CD\u4F5C",dataIndex:"operation",width:"18%",scopedSlots:{customRender:"operation"},align:"center"}]}),{selectedRowKeys:S,queryParams:s,columns:j}=he(Z),i=()=>{v.value=!0,Ve(g.addDateRange(s.value,y.value)).then(a=>{O.value=a.rows,q.value=a.total,v.value=!1})},ee=()=>{const a={path:"/monitor/job"};g.$tab.closeOpenPage(a)},z=()=>{s.value.pageNum=1,i()},te=()=>{y.value=[],g.resetForm("queryRef"),z()},I=a=>{S.value=a,G.value=!S.value.length},oe=a=>{T.value.show(a)},ae=a=>{Q.confirm({title:"\u786E\u8BA4\u5220\u9664?",icon:e(A),content:"\u662F\u5426\u5220\u9664\u9009\u4E2D\u6570\u636E",okText:"\u5220\u9664",okType:"danger",cancelText:"\u53D6\u6D88",onOk(){$e(a.jobIds).then(()=>{I([]),i(),H.success("\u5220\u9664\u6210\u529F",3)})},onCancel(){}})};function ne(){Q.confirm({title:"\u786E\u8BA4\u6E05\u7A7A?",icon:e(A),content:"\u662F\u5426\u6E05\u7A7A\u6240\u6709\u8C03\u5EA6\u65E5\u5FD7\u6570\u636E",okText:"\u6E05\u7A7A",okType:"danger",cancelText:"\u53D6\u6D88",onOk(){Je().then(()=>{I([]),i(),H.success("\u5220\u9664\u6210\u529F",3)})},onCancel(){}})}function le(){g.download("monitor/jobLog/export",{...s.value},`job_log_${new Date().getTime()}.xlsx`)}const se=(a,n)=>{s.value.pageSize=n,i()},ue=(a,n)=>{s.value.pageNum=a,s.value.pageSize=n,i()};return(()=>{const a=W.query.jobId;a!==void 0&&a!=0?qe(a).then(n=>{s.value.jobName=n.data.jobName,s.value.jobGroup=n.data.jobGroup,i()}):i()})(),i(),(a,n)=>{const ie=xe,w=Ye,b=Fe,Y=Se,B=ze,re=Ge,m=je("c-icon"),d=Ie,F=De,ce=Me,de=Be,M=Te,pe=Le,V=Ne,_e=Oe,me=Re,C=we("hasPermi");return u(),D("div",null,[e(M,{bordered:!1,class:"card card-search p-0",size:"small"},{default:t(()=>[e(de,{class:"search-form",model:l(s),ref:"queryRef","label-col":{span:6},"wrapper-col":{span:16}},{default:t(()=>[e(ce,{gutter:48},{default:t(()=>[e(b,{md:6,sm:24},{default:t(()=>[e(w,{label:"\u4EFB\u52A1\u540D\u79F0",name:"jobName"},{default:t(()=>[e(ie,{value:l(s).jobName,"onUpdate:value":n[0]||(n[0]=o=>l(s).jobName=o),placeholder:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\u79F0",allowClear:"",onKeyup:Ce(z,["enter"])},null,8,["value","onKeyup"])]),_:1})]),_:1}),e(b,{md:6,sm:24},{default:t(()=>[e(w,{label:"\u4EFB\u52A1\u7EC4\u540D",name:"jobGroup"},{default:t(()=>[e(B,{value:l(s).jobGroup,"onUpdate:value":n[1]||(n[1]=o=>l(s).jobGroup=o),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u7EC4\u540D",style:{width:"100%"}},{default:t(()=>[(u(!0),D($,null,J(l(R),(o,p)=>(u(),c(Y,{key:p,value:o.value},{default:t(()=>[r(P(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),e(b,{md:6,sm:24},{default:t(()=>[e(w,{label:"\u6267\u884C\u72B6\u6001",name:"status"},{default:t(()=>[e(B,{value:l(s).status,"onUpdate:value":n[2]||(n[2]=o=>l(s).status=o),placeholder:"\u8BF7\u9009\u62E9\u4EFB\u52A1\u72B6\u6001",style:{width:"100%"}},{default:t(()=>[(u(!0),D($,null,J(l(x),(o,p)=>(u(),c(Y,{key:p,value:o.value},{default:t(()=>[r(P(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),e(b,{md:6,sm:24},{default:t(()=>[e(w,{label:"\u6267\u884C\u65F6\u95F4",name:"status"},{default:t(()=>[e(re,{allowClear:"",style:{width:"100%"},value:y.value,"onUpdate:value":n[3]||(n[3]=o=>y.value=o),placeholder:["\u5F00\u59CB\u65E5\u671F","\u7ED3\u675F\u65E5\u671F"],format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD"},null,8,["value"])]),_:1})]),_:1}),e(b,{md:24,sm:24},{default:t(()=>[U("span",Pe,[e(F,null,{default:t(()=>[e(d,{type:"primary",onClick:z},{default:t(()=>[e(m,{type:"SearchOutlined"}),Ue]),_:1}),e(d,{onClick:te},{default:t(()=>[e(m,{type:"SyncOutlined"}),Ee]),_:1})]),_:1})])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(M,{bordered:!1,class:"card",size:"small"},{default:t(()=>[U("div",Qe,[e(F,null,{default:t(()=>[k((u(),c(d,{class:"is-plain",disabled:G.value,type:"danger",onClick:ae},{default:t(()=>[e(m,{type:"DeleteOutlined"}),Ae]),_:1},8,["disabled"])),[[C,["monitor:job:remove"]]]),k((u(),c(d,{class:"is-plain",type:"danger",onClick:ne},{default:t(()=>[e(m,{type:"DeleteOutlined"}),He]),_:1})),[[C,["monitor:job:remove"]]]),k((u(),c(d,{type:"cyan",onClick:le},{default:t(()=>[e(m,{type:"DownloadOutlined"}),We]),_:1})),[[C,["monitor:job:export"]]]),e(d,{type:"warn",onClick:ee},{default:t(()=>[e(m,{type:"CloseOutlined"}),Xe]),_:1})]),_:1}),e(pe,{class:"float-right",columns:l(j),"onUpdate:columns":n[4]||(n[4]=o=>E(j)?j.value=o:null),tableSize:l(h),"onUpdate:tableSize":n[5]||(n[5]=o=>E(h)?h.value=o:null),"refresh-loading":v.value,onRefresh:i},null,8,["columns","tableSize","refresh-loading"])]),e(_e,{loading:v.value,size:l(h),rowKey:"jobLogId",columns:l(j),"data-source":O.value,"row-selection":{selectedRowKeys:l(S),onChange:I},pagination:!1,bordered:X.value},{bodyCell:t(({column:o,record:p})=>[o.dataIndex==="jobGroup"?(u(),c(V,{key:0,options:l(R),value:p.jobGroup},null,8,["options","value"])):L("",!0),o.dataIndex==="status"?(u(),c(V,{key:1,options:l(x),value:p.status},null,8,["options","value"])):L("",!0),o.dataIndex==="operation"?k((u(),c(d,{key:2,class:"ant-btn-sm",type:"link",onClick:tt=>oe(p)},{default:t(()=>[Ze]),_:2},1032,["onClick"])),[[C,["monitor:job:query"]]]):L("",!0)]),_:1},8,["loading","size","columns","data-source","row-selection","bordered"]),e(me,{class:"ant-table-pagination float-right","show-size-changer":"","show-quick-jumper":"",current:l(s).pageNum,total:q.value,"page-size":l(s).pageSize,"show-total":o=>`\u5171 ${o} \u6761`,onShowSizeChange:se,onChange:ue},null,8,["current","total","page-size","show-total"]),e(Ke,{ref_key:"logView",ref:T,sys_common_status:l(x)},null,8,["sys_common_status"])]),_:1})])}}});export{jt as default};
