import{_ as $,j,a as A,r as G,k as O,l as u,d as T,f as t,o as x,c as H,w as h,v as w,i as s,m as n,q as J,e as g,s as K,F as P,x as b,y as Q,z as r,A as W,B as X,M as Y,I as Z,C as ee,D as se}from"./index.eed59c8a.js";/* empty css              */import{u as ae,L as oe,_ as te}from"./LoginFormTitle.228b63d7.js";import{d as ne,e as re}from"./jsencrypt.77186963.js";import"./index.e50e374b.js";import{_ as le}from"./Password.525a1a03.js";import"./index.eab2cc86.js";import{_ as ue,F as ce}from"./Form.ebe4e7a6.js";import{_ as ie,a as de}from"./index.bd68bfa1.js";import"./Group.69eabd48.js";import"./Search.63c74586.js";import"./isPlainObject.e1353217.js";const me={class:"flex"},_e={class:"login-code"},pe=["src"],ge=b("\u8BB0\u4F4F\u6211"),fe=b("\u767B \u5F55"),ve={__name:"LoginForm",setup(xe){const k=j(),F=A(),y=G({loginForm:{username:"admin",password:"admin123",code:"",uuid:""},loginRules:{username:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u8D26\u53F7"}],password:[{required:!0,trigger:"blur",message:"\u8BF7\u8F93\u5165\u60A8\u7684\u5BC6\u7801"}],code:[{required:!0,trigger:"change",message:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801"}]}}),{loginForm:e,loginRules:L}=O(y),{getLoginState:C}=ae(),S=u(),f=u(""),m=u(!0),_=u(!1),c=u(!1),B=u(void 0),v=T(()=>t(C)===oe.LOGIN),p=()=>{Q().then(a=>{m.value=a.captchaEnabled===void 0?!0:a.captchaEnabled,m.value&&(f.value="data:image/gif;base64,"+a.img,e.value.uuid=a.uuid)})},M=()=>{const a=r.get("rememberMe"),o=r.get("username"),i=r.get("password");e.value={username:o===void 0?e.value.username:o,password:i===void 0?e.value.password:ne(i)},c.value=a===void 0?!1:Boolean(a)},z=()=>{_.value=!0,c.value?(r.set("username",e.value.username,{expires:30}),r.set("password",re(e.value.password),{expires:30}),r.set("rememberMe",c.value,{expires:30})):(r.remove("username"),r.remove("password"),r.remove("rememberMe")),k.login(e.value).then(()=>{R()}).catch(a=>{U(a)})},R=()=>{F.push({path:B.value||"/"}),W.success({message:"\u6B22\u8FCE",description:`${X()}\uFF0C\u6B22\u8FCE\u56DE\u6765`})},U=a=>{Y.error({title:"\u9519\u8BEF\u63D0\u793A",content:a}),_.value=!1,m.value&&p()};return p(),M(),(a,o)=>{const i=Z,d=ue,E=le,I=ee,N=ie,q=de,V=se,D=ce;return x(),H(P,null,[h(s(te,{class:"enter-x"},null,512),[[w,t(v)]]),h(s(D,{class:"p-4 enter-x",model:t(e),rules:t(L),ref_key:"formRef",ref:S,onFinish:z},{default:n(()=>[s(d,{name:"username",class:"enter-x"},{default:n(()=>[s(i,{size:"large",value:t(e).username,"onUpdate:value":o[0]||(o[0]=l=>t(e).username=l),placeholder:"\u8BF7\u8F93\u5165\u8D26\u53F7",class:"fix-auto-fill"},null,8,["value"])]),_:1}),s(d,{name:"password",class:"enter-x"},{default:n(()=>[s(E,{size:"large",value:t(e).password,"onUpdate:value":o[1]||(o[1]=l=>t(e).password=l),placeholder:"\u8BF7\u8F93\u5165\u5BC6\u7801",class:"fix-auto-fill"},null,8,["value"])]),_:1}),m.value?(x(),J(d,{key:0,name:"code",class:"enter-x"},{default:n(()=>[g("div",me,[s(i,{size:"large",value:t(e).code,"onUpdate:value":o[2]||(o[2]=l=>t(e).code=l),placeholder:"\u8BF7\u8F93\u5165\u9A8C\u8BC1\u7801",class:"fix-auto-fill"},null,8,["value"]),g("div",_e,[g("img",{src:f.value,onClick:p,class:"login-code-img"},null,8,pe)])])]),_:1})):K("",!0),s(q,{class:"enter-x"},{default:n(()=>[s(N,{span:12},{default:n(()=>[s(d,null,{default:n(()=>[s(I,{checked:c.value,"onUpdate:checked":o[3]||(o[3]=l=>c.value=l),size:"small"},{default:n(()=>[ge]),_:1},8,["checked"])]),_:1})]),_:1})]),_:1}),s(d,{class:"enter-x"},{default:n(()=>[s(V,{type:"primary",size:"large",block:"","html-type":"handleLogin",loading:_.value},{default:n(()=>[fe]),_:1},8,["loading"])]),_:1})]),_:1},8,["model","rules"]),[[w,t(v)]])],64)}}};var Re=$(ve,[["__scopeId","data-v-15c453e2"]]);export{Re as default};
